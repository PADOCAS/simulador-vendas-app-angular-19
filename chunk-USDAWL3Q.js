import{a as J}from"./chunk-V24UY7B3.js";import{a as K}from"./chunk-5LEE6PLE.js";import{a as Q}from"./chunk-R5EPPCOU.js";import{A as w,D as G,E as O,F as B,G as V,H as k,I as R,J as $,f as b,h as M,ja as z,ka as H,l as I,m as u,n as x,o as q,p as y,q as P,s as T,t as N,u as A,v as D,w as L,y as U,z as j}from"./chunk-P3YZ4GKF.js";import{Ac as _,Bc as F,Db as p,Hb as i,Ib as t,Jb as v,Qb as g,ac as o,bb as a,cb as s,cc as h,d as C,nb as S,sb as c,t as E,yb as m}from"./chunk-DSNXJSX2.js";function Y(r,l){r&1&&(i(0,"div")(1,"mat-form-field",16)(2,"mat-label"),o(3,"Id"),t(),v(4,"input",17),t()())}function Z(r,l){r&1&&(i(0,"mat-error"),o(1,"Descri\xE7\xE3o \xE9 "),i(2,"strong"),o(3,"requerida"),t()())}function ee(r,l){r&1&&(i(0,"mat-error"),o(1,"Descri\xE7\xE3o deve ter no m\xEDnimo 3 caracteres"),t())}function te(r,l){r&1&&(i(0,"mat-error"),o(1,"Unidade Medida \xE9 "),i(2,"strong"),o(3,"requerida"),t()())}function ie(r,l){r&1&&(i(0,"mat-error"),o(1,"Unidade Medida deve ter no m\xEDnimo 2 caracteres"),t())}function oe(r,l){if(r&1&&(i(0,"mat-option",10)(1,"mat-icon"),o(2,"category"),t(),o(3),t()),r&2){let e=l.$implicit;m("value",e.id),a(3),h(" ","("+e.id+") "+e.nome," ")}}function re(r,l){r&1&&(i(0,"mat-error"),o(1,"Categoria \xE9 "),i(2,"strong"),o(3,"requerida"),t()())}function ae(r,l){if(r&1&&(i(0,"mat-option",10)(1,"mat-icon"),o(2,"business"),t(),o(3),t()),r&2){let e=l.$implicit;m("value",e.id),a(3),h(" ","("+e.id+") "+e.razaoSocial," ")}}function ne(r,l){r&1&&(i(0,"mat-error"),o(1,"Fornecedor \xE9 "),i(2,"strong"),o(3,"requerido"),t()())}var Me=(()=>{class r{constructor(e,n,d,f,W,X){this.produtosService=e,this.fornecedoresService=n,this.categoriasService=d,this.form=f,this.router=W,this.routeActive=X,this.showLoading=!1,this.listFornecedor=null,this.listCategoria=null,this.produtoForm=this.form.group({id:[null],fornecedorId:[null,u.required],categoriaId:[null,u.required],unidadeMedida:["",[u.required,u.minLength(2)]],precoUnitario:[null,[u.required]],qtdeEstoque:[null,[u.required]],ativo:[!0,[u.required]],descricao:["",[u.required,u.minLength(3)]]})}ngOnInit(){this.routeActive!==void 0&&this.routeActive!==null&&this.routeActive.snapshot!==void 0&&this.routeActive.snapshot!==null&&this.routeActive.snapshot.paramMap!==void 0&&this.routeActive.snapshot.paramMap!==null&&this.routeActive.snapshot.paramMap.get("id")!==void 0&&this.routeActive.snapshot.paramMap.get("id")!==null&&this.produtosService.pegar(Number(this.routeActive.snapshot.paramMap.get("id"))).subscribe(e=>{if(e!=null){let n=e;this.produtoForm.setValue({id:n.id,fornecedorId:n.fornecedorId||null,categoriaId:n.categoriaId||null,unidadeMedida:n.unidadeMedida,precoUnitario:n.precoUnitario,qtdeEstoque:n.qtdeEstoque,ativo:n.ativo,descricao:n.descricao}),this.produtoForm.get("id")?.disable()}}),this.fornecedoresService.getFornecedores().subscribe(e=>{this.listFornecedor=e},e=>{console.log("Erro ao carregar Fornecedores: "+e)}),this.categoriasService.getCategorias().subscribe(e=>{this.listCategoria=e},e=>{console.log("Erro ao carregar Categorias: "+e)})}onSubmit(){this.onSave(this.convertFormBuilderGroupToProduto())}convertFormBuilderGroupToProduto(){this.produtoForm.get("id")?.enable();let e=this.produtoForm.value;return this.produtoForm.get("id")?.disable(),{id:e.id??0,fornecedorId:e.fornecedorId??0,categoriaId:e.categoriaId??0,unidadeMedida:e.unidadeMedida||"",precoUnitario:e.precoUnitario||null,qtdeEstoque:e.qtdeEstoque||null,ativo:e.ativo||!0,descricao:e.descricao||""}}onSave(e){return C(this,null,function*(){this.showLoading=!0;let n=yield E(this.produtosService.salvar(e));this.showLoading=!1,this.router.navigate(["/produtos"])})}cancelar(){this.router.navigate(["/produtos"])}static{this.\u0275fac=function(n){return new(n||r)(s(Q),s(K),s(J),s(N),s(M),s(b))}}static{this.\u0275cmp=S({type:r,selectors:[["app-cad-produto"]],decls:43,vars:14,consts:[["novalidate","",3,"ngSubmit","formGroup"],[4,"ngIf"],[1,"container",2,"display","flex"],[1,"item",2,"flex","3"],["matInput","","formControlName","descricao"],[1,"item",2,"flex","1"],["matInput","","formControlName","unidadeMedida"],[1,"container"],[1,"item"],["formControlName","categoriaId","placeholder","Selecione uma Categoria..."],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","fornecedorId","placeholder","Selecione um fornecedor..."],["mat-raised-button","","color","primary","type","submit",2,"margin-right","8px !important","margin-bottom","16px !important",3,"disabled"],["type","button","mat-raised-button","","color","primary",2,"margin-bottom","16px !important",3,"click"],[3,"visible"],[1,"item-20"],["matInput","","formControlName","id"]],template:function(n,d){if(n&1&&(i(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),o(3,"Produto"),t()(),i(4,"mat-card-content")(5,"form",0),g("ngSubmit",function(){return d.onSubmit()}),i(6,"div"),c(7,Y,5,0,"div",1),i(8,"div",2)(9,"mat-form-field",3)(10,"mat-label"),o(11,"Descri\xE7\xE3o"),t(),v(12,"input",4),c(13,Z,4,0,"mat-error")(14,ee,2,0,"mat-error"),t(),i(15,"mat-form-field",5)(16,"mat-label"),o(17,"Unidade Medida"),t(),v(18,"input",6),c(19,te,4,0,"mat-error")(20,ie,2,0,"mat-error"),t()(),i(21,"div",7)(22,"mat-form-field",8)(23,"mat-label"),o(24,"Categoria"),t(),i(25,"mat-select",9)(26,"mat-option",10),o(27," Selecione uma Categoria... "),t(),c(28,oe,4,2,"mat-option",11),t(),c(29,re,4,0,"mat-error"),t(),i(30,"mat-form-field",8)(31,"mat-label"),o(32,"Fornecedor"),t(),i(33,"mat-select",12)(34,"mat-option",10),o(35," Selecione um Fornecedor... "),t(),c(36,ae,4,2,"mat-option",11),t(),c(37,ne,4,0,"mat-error"),t()()(),i(38,"button",13),o(39," Salvar "),t(),i(40,"button",14),g("click",function(){return d.cancelar()}),o(41," Cancelar "),t()()(),v(42,"app-loading-bar",15),t()),n&2){let f;a(5),m("formGroup",d.produtoForm),a(2),m("ngIf",((f=d.produtoForm.get("id"))==null?null:f.value)!==null),a(6),p(d.produtoForm.controls.descricao.hasError("required")?13:-1),a(),p(d.produtoForm.controls.descricao.hasError("minlength")?14:-1),a(5),p(d.produtoForm.controls.unidadeMedida.hasError("required")?19:-1),a(),p(d.produtoForm.controls.unidadeMedida.hasError("minlength")?20:-1),a(6),m("value",null),a(2),m("ngForOf",d.listCategoria),a(),p(d.produtoForm.controls.categoriaId.hasError("required")?29:-1),a(5),m("value",null),a(2),m("ngForOf",d.listFornecedor),a(),p(d.produtoForm.controls.fornecedorId.hasError("required")?37:-1),a(),m("disabled",!d.produtoForm.valid),a(4),m("visible",d.showLoading)}},dependencies:[A,y,I,x,q,P,T,z,L,O,R,k,B,V,U,w,G,j,F,H,$,D,_],encapsulation:2})}}return r})();export{Me as CadProdutoComponent};
